<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <COLLECTIONS DEFAULT="NoCollection" />
    <EXPANSIONS>
        <E COMPOSITE="C[0]" NUMMODES="2" TYPE="MODIFIED" FIELDS="n,T_e,u_e,w,phi" />
    </EXPANSIONS>

    <CONDITIONS>
        <SOLVERINFO>
            <I PROPERTY="EQTYPE" VALUE="RogersRicci3D" />
            <I PROPERTY="Projection" VALUE="DisContinuous" />
            <I PROPERTY="TimeIntegrationMethod" VALUE="DIRKOrder2" />
            <I PROPERTY="AdvectionAdvancement"  VALUE="Implicit" />
        </SOLVERINFO>

        <PARAMETERS>
            <P> NumSteps       = 100000              </P>
            <P> TimeStep       = 2e-3               </P>
            <P> IO_InfoSteps   = 10                </P>
            <P> IO_CheckSteps  = 100                </P>
            <P> ue_scale=1.0 </P>
            <!-- Model params -->
            <P> mu  = 0.04 </P>
            <P> tau = 25.0 </P> <!-- scaled down from 400 for now -->
            <!-- For ICs set up -->
            <P> zmin  = -18.0  </P>
            <P> zsize  = 36.0  </P>
            <P> zICs_omega = 2 </P>
        </PARAMETERS>

        <VARIABLES>
            <V ID="0"> n </V>
            <V ID="1"> T_e </V>
            <V ID="2"> u_e </V>
            <V ID="3"> w </V>
            <V ID="4"> phi </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[1-4] </B>
            <B ID="1"> C[5] </B>
            <B ID="2"> C[6] </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <D VAR="n"   VALUE="1e-4" />
                <D VAR="T_e" VALUE="1e-4" />
                <D VAR="w"   VALUE="0" />
                <N VAR="u_e" VALUE="0" />
                <D VAR="phi" VALUE="0.03" />
            </REGION>
            <REGION REF="1">
                <N VAR="n" USERDEFINEDTYPE="None" VALUE="0" />`
                <N VAR="T_e" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="w" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="u_e" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="phi" VALUE="0" />
            </REGION>
            <REGION REF="2">
                <N VAR="n" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="T_e" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="w" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="u_e" USERDEFINEDTYPE="None" VALUE="0" />
                <N VAR="phi" VALUE="0" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="InitialConditions">
            <E VAR="n"   VALUE="1e-4" />
            <E VAR="T_e" VALUE="1e-4" />
            <E VAR="w"   VALUE="0" />
            <E VAR="u_e" VALUE="ue_scale*(2*(z-zmin)/zsize-1)" />
            <E VAR="phi" VALUE="0.03" />
        </FUNCTION>
    </CONDITIONS>
</NEKTAR>
